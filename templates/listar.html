<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Folios Generados</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { background: #002b36; color: #eee; font-family: Arial, sans-serif; padding: 10px; }
        h2 { text-align: center; margin-bottom: 15px; }
        table { width:100%; border-collapse:collapse; background:#073642; }
        th, td { padding:8px; border-bottom:1px solid #555; font-size:14px; text-align:left; }
        th { background:#005f87; }
        a { color:#268bd2; text-decoration:underline; }
        .btn-renovar { background:#b58900; padding:6px 10px; border-radius:4px; color:#fff; text-decoration:none; font-size:13px; }
        .volver { margin-top:20px; text-align:center; }
        .volver a button {
          background:#268bd2; color:#fff; border:none; padding:10px 20px; border-radius:6px; font-size:16px;
        }
        .eliminar-btn {
          margin:15px 0;
          background:#c00;
          color:#fff;
          border:none;
          border-radius:6px;
          padding:12px 25px;
          font-size:16px;
          cursor:pointer;
        }
    </style>
</head>
<body>
    <h2>Folios Generados</h2>
    <form method="POST" action="{{ url_for('eliminar_varios') }}">
      <table>
        <thead>
          <tr>
            <th><input type="checkbox" id="check_all" onclick="marcarTodos(this)"></th>
            <th>Folio</th>
            <th>Marca</th>
            <th>Línea</th>
            <th>Año</th>
            <th>Serie</th>
            <th>Motor</th>
            <th>Color</th>
            <th>Contribuyente</th>
            <th>Expedición</th>
            <th>Vencimiento</th>
            <th>PDF</th>
            <th>Renovar</th>
          </tr>
        </thead>
        <tbody>
          {% for reg in registros %}
          <tr>
            <td><input type="checkbox" name="folios" value="{{ reg.folio }}"></td>
            <td>{{ reg.folio }}</td>
            <td>{{ reg.marca }}</td>
            <td>{{ reg.linea }}</td>
            <td>{{ reg.anio }}</td>
            <td>{{ reg.serie }}</td>
            <td>{{ reg.motor }}</td>
            <td>{{ reg.color }}</td>
            <td>{{ reg.contribuyente }}</td>
            <td>{{ reg.fecha_exp }}</td>
            <td>{{ reg.fecha_venc }}</td>
            <td><a href="{{ url_for('descargar', folio=reg.folio) }}">Descargar</a></td>
            <td>
              {% set v = reg.fecha_venc.split('/') %}
              {% set venc_str = v[2] ~ '-' ~ v[1] ~ '-' ~ v[0] %}
              {% if venc_str <= ahora.strftime('%Y-%m-%d') %}
                <a href="{{ url_for('renovar', folio=reg.folio) }}" class="btn-renovar">Renovar</a>
              {% else %}
                <span style="color:gray;">Vigente</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <button type="submit" class="eliminar-btn">Eliminar seleccionados</button>
    </form>
    <div class="volver">
        <a href="{{ url_for('formulario') }}"><button>Volver al Panel</button></a>
    </div>
    <script>
      function marcarTodos(box) {
        var checks = document.querySelectorAll('input[type=checkbox][name=folios]');
        checks.forEach(chk => chk.checked = box.checked);
      }
    </script>
</body>
</html>
